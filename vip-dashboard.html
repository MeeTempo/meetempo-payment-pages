<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>MeeTempo VIP</title>
    
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;800;900&display=swap" rel="stylesheet">
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: { sans: ['Montserrat', 'sans-serif'] },
                    colors: {
                        gold: {
                            light: '#FDE047', // Jaune clair
                            DEFAULT: '#F59E0B', // Or standard
                            dark: '#B45309', // Or foncÃ©
                        },
                        deep: {
                            bg: '#0f172a', // Bleu gris trÃ¨s sombre (plus doux que le noir)
                            card: '#1e293b'
                        }
                    },
                    animation: {
                        'shine': 'shine 3s infinite linear',
                        'float': 'float 6s ease-in-out infinite',
                    },
                    keyframes: {
                        shine: {
                            '0%': { backgroundPosition: '200% center' },
                            '100%': { backgroundPosition: '-200% center' },
                        },
                        float: {
                            '0%, 100%': { transform: 'translateY(0)' },
                            '50%': { transform: 'translateY(-10px)' },
                        }
                    }
                }
            }
        }
    </script>

    <style>
        body {
            /* Fond plus riche avec un "spotlight" dorÃ© au centre */
            background: radial-gradient(circle at 50% 0%, #4a3812 0%, #0f172a 60%, #020617 100%);
            color: white;
            padding-bottom: 90px;
        }

        /* Texte Or MÃ©tallique */
        .text-gradient-gold {
            background: linear-gradient(to right, #FDE047, #F59E0B, #FDE047);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-size: 200% auto;
            animation: shine 4s linear infinite;
        }

        /* Carte "Glassmorphism" (Effet verre premium) */
        .glass-card {
            background: rgba(255, 255, 255, 0.07);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 215, 0, 0.15);
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.3);
        }

        /* Carte VIP principale (Holographique) */
        .vip-pass-card {
            background: linear-gradient(135deg, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0.05) 100%);
            border: 1px solid rgba(253, 224, 71, 0.3);
            position: relative;
            overflow: hidden;
        }
        .vip-pass-card::before {
            content: '';
            position: absolute;
            top: -50%; left: -50%; width: 200%; height: 200%;
            background: radial-gradient(circle, rgba(253, 224, 71, 0.1) 0%, transparent 70%);
            animation: rotate 10s linear infinite;
        }

        /* Barre de progression brillante */
        .progress-glow {
            box-shadow: 0 0 15px rgba(245, 158, 11, 0.6);
        }
    </style>
</head>
<body class="min-h-screen">

    <div class="p-4 pt-6">
        <div class="vip-pass-card rounded-2xl p-6 shadow-2xl animate-float relative">
            <div class="absolute top-0 right-0 w-32 h-32 bg-yellow-500 opacity-20 rounded-full blur-3xl -mr-10 -mt-10"></div>
            
            <div class="relative z-10">
                <div class="flex justify-between items-start mb-8">
                    <div class="bg-black/30 backdrop-blur-md px-3 py-1 rounded-full border border-yellow-500/30">
                        <span class="text-xs font-bold text-yellow-400 tracking-widest uppercase">MeeTempo VIP</span>
                    </div>
                    <i class="fas fa-crown text-3xl text-gradient-gold drop-shadow-lg"></i>
                </div>

                <div class="mb-1">
                    <h1 class="text-2xl font-black tracking-wide text-white uppercase" id="user-name">ALEXANDRE</h1>
                    <div class="text-xs text-yellow-200/70 font-mono tracking-widest">MEMBER SINCE 2025</div>
                </div>
            </div>
        </div>
    </div>

    <main class="px-4 space-y-6">

        <div class="text-center -mt-2">
            <div class="inline-flex items-center gap-2 mb-2">
                <span class="text-sm font-bold text-gray-400">Niveau Actuel</span>
                <span class="text-xl font-black text-yellow-400" id="level-badge">GOLD</span>
            </div>
            
            <div class="relative h-6 bg-gray-800 rounded-full border border-gray-700 shadow-inner overflow-hidden">
                <div class="absolute inset-0 opacity-20" style="background-image: repeating-linear-gradient(45deg, transparent, transparent 10px, #000 10px, #000 20px);"></div>
                <div id="xp-bar" class="absolute top-0 left-0 h-full bg-gradient-to-r from-yellow-600 via-yellow-400 to-yellow-200 progress-glow transition-all duration-1000" style="width: 0%"></div>
                <div class="absolute inset-0 flex items-center justify-center text-[10px] font-bold text-black z-10">
                    <span id="xp-text">0 / 1000 XP</span>
                </div>
            </div>
            <p class="text-xs text-gray-500 mt-2">Plus que <span class="text-white font-bold">150 XP</span> pour le niveau Platinum ðŸ’Ž</p>
        </div>

        <div class="grid grid-cols-2 gap-4">
            <div class="glass-card p-4 rounded-xl text-center relative overflow-hidden group cursor-pointer transition hover:scale-[1.02]">
                <div class="absolute inset-0 bg-gradient-to-b from-yellow-500/10 to-transparent opacity-0 group-hover:opacity-100 transition"></div>
                <div class="text-3xl mb-1">ðŸª™</div>
                <div class="text-2xl font-black text-white" id="points-total">...</div>
                <div class="text-[10px] uppercase tracking-wider text-yellow-500 font-bold">MeeCoins</div>
            </div>

            <div class="glass-card p-4 rounded-xl text-center relative overflow-hidden group cursor-pointer transition hover:scale-[1.02]">
                <div class="absolute inset-0 bg-gradient-to-b from-blue-500/10 to-transparent opacity-0 group-hover:opacity-100 transition"></div>
                <div class="text-3xl mb-1">ðŸ‘¥</div>
                <div class="text-2xl font-black text-white" id="referral-count">...</div>
                <div class="text-[10px] uppercase tracking-wider text-blue-400 font-bold">Filleuls</div>
            </div>
        </div>

        <div class="glass-card p-1 rounded-2xl">
            <div class="bg-black/20 rounded-xl p-5 border border-white/5">
                <div class="flex items-center gap-3 mb-4">
                    <div class="w-10 h-10 rounded-full bg-gradient-to-br from-purple-600 to-blue-600 flex items-center justify-center shadow-lg border border-white/20">
                        <i class="fas fa-rocket text-white text-lg"></i>
                    </div>
                    <div>
                        <h3 class="font-bold text-white text-sm">Mission Parrainage</h3>
                        <p class="text-[10px] text-gray-400">Invitez des amis, gagnez du VIP.</p>
                    </div>
                </div>

                <div class="relative mb-3 group">
                    <div class="absolute -inset-0.5 bg-gradient-to-r from-yellow-600 to-purple-600 rounded-lg blur opacity-30 group-hover:opacity-75 transition duration-1000"></div>
                    <div class="relative flex">
                        <input type="text" id="referral-link" readonly 
                            class="w-full bg-gray-900 text-gray-300 text-xs p-3 rounded-l-lg border border-gray-700 focus:outline-none font-mono"
                            value="Chargement...">
                        <button onclick="copyLink()" class="bg-gradient-to-r from-yellow-600 to-yellow-500 text-black font-bold px-4 rounded-r-lg text-xs hover:brightness-110 transition">
                            COPIER
                        </button>
                    </div>
                </div>
                
                <div class="flex justify-between items-center text-[10px] text-gray-400 px-1">
                    <span>RÃ©compense :</span>
                    <span class="text-yellow-400 font-bold">+30 XP par ami</span>
                </div>
            </div>
        </div>

        <div>
            <h2 class="text-lg font-black text-white mb-4 flex items-center">
                <i class="fas fa-gift text-purple-400 mr-2"></i> BUTIN
            </h2>
            <div class="space-y-3" id="rewards-list">
                <div class="glass-card p-4 rounded-xl flex items-center justify-center">
                    <i class="fas fa-circle-notch fa-spin text-yellow-500"></i>
                </div>
            </div>
        </div>

        <div id="b2b-section" class="hidden mt-6">
            <div class="relative rounded-2xl overflow-hidden p-1 bg-gradient-to-r from-indigo-500 via-purple-500 to-pink-500">
                <div class="bg-gray-900 rounded-xl p-5 relative h-full">
                    <div class="absolute top-0 right-0 bg-white text-black text-[10px] font-bold px-2 py-1 rounded-bl-lg">BOSS MODE</div>
                    <h3 class="font-bold text-white mb-1">Dirigeant ?</h3>
                    <p class="text-xs text-gray-400 mb-3">Passez votre Ã©quipe en VIP et ne payez plus jamais.</p>
                    <button onclick="goToB2B()" class="w-full bg-white/10 hover:bg-white/20 text-white border border-white/20 py-2 rounded-lg text-xs font-bold transition">
                        ACTIVER MODE ENTREPRISE
                    </button>
                </div>
            </div>
        </div>

    </main>

    <nav class="fixed bottom-4 left-4 right-4 bg-[#0f172a]/80 backdrop-blur-xl border border-white/10 rounded-2xl shadow-2xl z-50 h-16 flex items-center justify-around px-2">
        <button onclick="goToMap()" class="flex flex-col items-center justify-center w-12 text-gray-400 hover:text-white transition">
            <i class="fas fa-map text-lg mb-1"></i>
            <span class="text-[9px]">Carte</span>
        </button>
        
        <button onclick="goToRequests()" class="flex flex-col items-center justify-center w-12 text-gray-400 hover:text-white transition">
            <i class="fas fa-inbox text-lg mb-1"></i>
            <span class="text-[9px]">Inbox</span>
        </button>

        <button onclick="createNew()" class="relative -top-6">
            <div class="absolute inset-0 bg-yellow-500 rounded-full blur opacity-40 animate-pulse"></div>
            <div class="relative bg-gradient-to-br from-yellow-400 to-orange-500 w-14 h-14 rounded-full flex items-center justify-center shadow-lg border-4 border-[#0f172a] text-black transform transition active:scale-95">
                <i class="fas fa-plus text-xl"></i>
            </div>
        </button>

        <button onclick="goToSuggestions()" class="flex flex-col items-center justify-center w-12 text-gray-400 hover:text-white transition">
            <i class="fas fa-list text-lg mb-1"></i>
            <span class="text-[9px]">Listes</span>
        </button>

        <button class="flex flex-col items-center justify-center w-12">
            <i class="fas fa-crown text-lg mb-1 text-yellow-400 drop-shadow-[0_0_5px_rgba(250,204,21,0.8)]"></i>
            <span class="text-[9px] font-bold text-yellow-400">VIP</span>
        </button>
    </nav>

    <script>
        const API_BASE = 'https://api.meetempo.com';
        
        document.addEventListener('DOMContentLoaded', async () => {
            const urlParams = new URLSearchParams(window.location.search);
            let token = urlParams.get('session_token') || urlParams.get('token') || sessionStorage.getItem('meetempo_token');
            
            if (!token) { window.location.href = 'login.html'; return; }
            
            sessionStorage.setItem('meetempo_token', token);
            await loadVipData(token);
        });

        async function loadVipData(token) {
            try {
                // Simulation des donnÃ©es (Remplacer par fetch rÃ©el)
                // const profile = await (await fetch(`${API_BASE}/profile?session_token=${token}`)).json();
                
                // MOCK TEMPORAIRE POUR LE STYLE
                const profile = { 
                    first_name: "Alexandre", 
                    vip_score: 75, 
                    job_level: "dirigeant",
                    referral_code: "VIP-ALEX-2025",
                    points: 750,
                    referral_count: 5
                };

                renderDashboard(profile);
            } catch (err) { console.error(err); }
        }

        function renderDashboard(user) {
            document.getElementById('user-name').textContent = user.first_name;
            
            // Animation Barre XP
            const score = user.vip_score || 0;
            document.getElementById('xp-text').textContent = `${score * 10} / 1000 XP`;
            setTimeout(() => {
                document.getElementById('xp-bar').style.width = `${score}%`;
            }, 500);

            // Stats
            document.getElementById('points-total').textContent = user.points || 0;
            document.getElementById('referral-count').textContent = user.referral_count || 0;
            document.getElementById('referral-link').value = `https://meetempo.com/?ref=${user.referral_code}`;

            // B2B
            if (user.job_level === 'dirigeant') {
                document.getElementById('b2b-section').classList.remove('hidden');
            }

            // Rewards GamifiÃ©s
            const rewards = [
                { xp: 500, title: "Badge VÃ©tÃ©ran", icon: "ðŸŽ–ï¸", type: "badge" },
                { xp: 1000, title: "1 Mois Gratuit", icon: "ðŸŽ", type: "item" },
                { xp: 2000, title: "Statut Platinum", icon: "ðŸ’Ž", type: "status" }
            ];

            const container = document.getElementById('rewards-list');
            container.innerHTML = rewards.map(r => {
                const unlocked = (user.points || 750) >= r.xp;
                // Style Loot Box
                return `
                <div class="glass-card p-3 rounded-xl flex items-center gap-4 ${unlocked ? 'border-yellow-500/50 bg-yellow-500/5' : 'opacity-60 grayscale'} transition">
                    <div class="w-12 h-12 rounded-lg bg-black/40 flex items-center justify-center text-2xl border border-white/10 shadow-inner">
                        ${r.icon}
                    </div>
                    <div class="flex-1">
                        <div class="flex justify-between items-center mb-1">
                            <h3 class="text-sm font-bold text-white">${r.title}</h3>
                            <span class="text-[10px] font-mono text-gray-400">${r.xp} XP</span>
                        </div>
                        <div class="w-full bg-gray-800 h-1.5 rounded-full overflow-hidden">
                            <div class="bg-${unlocked ? 'green-500' : 'gray-600'} h-full" style="width: ${Math.min(100, (user.points/r.xp)*100)}%"></div>
                        </div>
                    </div>
                    ${unlocked 
                        ? `<button class="bg-yellow-500 text-black text-[10px] font-bold px-3 py-1 rounded shadow-lg animate-pulse">RÃ‰CUP</button>` 
                        : `<i class="fas fa-lock text-gray-500"></i>`}
                </div>`;
            }).join('');
        }

        function copyLink() {
            const input = document.getElementById('referral-link');
            input.select();
            navigator.clipboard.writeText(input.value);
            alert('Lien copiÃ© ! ðŸš€');
        }

        // Navigation functions
        function getToken() { return sessionStorage.getItem('meetempo_token'); }
        function goToRequests() { window.location.href = `my-requests.html?session_token=${getToken()}`; }
        function goToSuggestions() { window.location.href = `my-suggestions.html?session_token=${getToken()}`; }
        function createNew() { window.location.href = `create-suggestion.html?token=${getToken()}`; }
        function goToB2B() { window.location.href = `b2b-dashboard.html?session_token=${getToken()}`; }
        
        async function goToMap() {
            const token = getToken();
            try {
                const res = await fetch(`${API_BASE}/auth/elevate-session?session_token=${token}`);
                if (!res.ok) throw new Error('Auth fail');
                const data = await res.json();
                window.location.href = `map.html?token=${data.token}`;
            } catch(e) {
                alert('Erreur de connexion');
                window.location.href = 'login.html';
            }
        }
    </script>
</body>
</html>
